{% comment %}
Beautiful Newsletter Popup Design
Two-column layout: Left (black content), Right (white image)
{% endcomment %}

{%- liquid
  assign form_id = 'beautifulNewsletterForm' | append: section.id
  assign logo_image = section.settings.logo_image
  assign logo_text = section.settings.logo_text | default: shop.name
  assign headline_main = section.settings.headline_main | default: 'EXCLUSIVE DISCOUNT'
  assign headline_sub = section.settings.headline_sub
  assign description_text = section.settings.description_text | default: 'Join the family and get exclusive email-only offers by signing up.'
  assign email_label = section.settings.email_label | default: 'ENTER YOUR EMAIL'
  assign button_text = section.settings.button_text | default: 'UNLOCK YOUR OFFER'
  assign popup_width = section.settings.popup_width | default: 70
  assign popup_height = section.settings.popup_height | default: 70
  assign logo_size = section.settings.logo_size | default: 32
  assign headline_main_size = section.settings.headline_main_size | default: 48
  assign headline_sub_size = section.settings.headline_sub_size | default: 18
  assign description_size = section.settings.description_size | default: 14
  assign email_label_size = section.settings.email_label_size | default: 12
  assign email_input_size = section.settings.email_input_size | default: 16
  assign email_input_padding = section.settings.email_input_padding | default: 16
  assign button_font_size = section.settings.button_font_size | default: 14
  assign button_padding = section.settings.button_padding | default: 18
-%}

<style>
  .beautiful-newsletter-popup {
    width: {{ popup_width }}vw;
    max-width: 95vw;
    height: {{ popup_height }}vh;
    max-height: 95vh;
    margin: 0 auto;
    background: #ffffff;
    border-radius: clamp(4px, 1%, 8px);
    overflow: hidden;
    position: relative;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
  }
  
  @media (max-width: 749px) {
    .beautiful-newsletter-popup {
      width: 95vw !important;
      max-width: 95vw !important;
      height: auto !important;
      min-height: auto;
      max-height: 95vh;
    }
  }
  
  @media (max-width: 480px) {
    .beautiful-newsletter-popup {
      width: 100vw !important;
      max-width: 100vw !important;
      height: auto !important;
      min-height: auto;
      max-height: 100vh;
      border-radius: 0;
    }
  }
  
  @media (min-width: 1200px) {
    .beautiful-newsletter-popup {
      max-width: {{ popup_width | times: 12 | round }}px;
    }
  }
  
  @media (min-width: 1920px) {
    .beautiful-newsletter-popup {
      max-width: {{ popup_width | times: 19.2 | round }}px;
      max-height: {{ popup_height | times: 10.8 | round }}px;
    }
  }
  
  .beautiful-newsletter-popup__container {
    display: flex;
    flex-direction: column;
    flex: 1;
    min-height: 0;
    height: 100%;
  }
  
  @media (min-width: 750px) {
    .beautiful-newsletter-popup__container {
      flex-direction: row;
    }
  }
  
  .beautiful-newsletter-popup__left {
    background: #000000;
    color: #ffffff;
    padding: 8% 6%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    position: relative;
    flex: 1;
    min-height: 100%;
    height: 100%;
    overflow-y: auto;
  }
  
  @media (max-width: 749px) {
    .beautiful-newsletter-popup__left {
      padding: 10% 8%;
      min-height: auto;
      width: 100%;
      flex: 1 1 100%;
      height: auto;
    }
  }
  
  @media (max-width: 480px) {
    .beautiful-newsletter-popup__left {
      padding: 10% 5%;
    }
  }
  
  .beautiful-newsletter-popup__close {
    position: absolute;
    top: 15px;
    right: 15px;
    background: #000000;
    border: none;
    width: 35px;
    height: 35px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    z-index: 10;
    color: #ffffff;
    font-size: 20px;
    line-height: 1;
    transition: transform 0.2s;
  }
  
  @media (max-width: 749px) {
    .beautiful-newsletter-popup__close {
      top: 12px;
      right: 12px;
      width: 32px;
      height: 32px;
      font-size: 18px;
    }
  }
  
  @media (max-width: 480px) {
    .beautiful-newsletter-popup__close {
      top: 10px;
      right: 10px;
      width: 30px;
      height: 30px;
      font-size: 16px;
    }
  }
  
  .beautiful-newsletter-popup__close:hover {
    transform: scale(1.1);
  }
  
  .beautiful-newsletter-popup__logo {
    font-size: {{ logo_size }}px;
    font-weight: 700;
    letter-spacing: 2px;
    margin-bottom: 20px;
    color: #ffffff;
    text-transform: uppercase;
  }
  
  @media (max-width: 749px) {
    .beautiful-newsletter-popup__logo {
      font-size: {{ logo_size | times: 0.8 | round }}px;
      margin-bottom: 15px;
    }
  }
  
  .beautiful-newsletter-popup__logo .logo-accent {
    color: #ff0000;
  }
  
  .beautiful-newsletter-popup__logo img {
    max-width: 100%;
    height: auto;
    max-height: {{ logo_size | times: 2 }}px;
    display: block;
  }
  
  @media (max-width: 749px) {
    .beautiful-newsletter-popup__logo img {
      max-height: {{ logo_size | times: 1.5 }}px;
    }
  }
  
  .beautiful-newsletter-popup__headline-main {
    font-size: {{ headline_main_size }}px;
    font-weight: 900;
    color: #ff0000;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 15px;
    line-height: 1.1;
  }
  
  @media (max-width: 749px) {
    .beautiful-newsletter-popup__headline-main {
      font-size: {{ headline_main_size | times: 0.7 | round }}px;
      margin-bottom: 12px;
    }
  }
  
  @media (max-width: 480px) {
    .beautiful-newsletter-popup__headline-main {
      font-size: {{ headline_main_size | times: 0.6 | round }}px;
    }
  }
  
  .beautiful-newsletter-popup__headline-sub {
    font-size: {{ headline_sub_size }}px;
    font-weight: 600;
    color: #ffffff;
    text-transform: uppercase;
    letter-spacing: 2px;
    margin-bottom: 20px;
    line-height: 1.3;
  }
  
  @media (max-width: 749px) {
    .beautiful-newsletter-popup__headline-sub {
      font-size: {{ headline_sub_size | times: 0.9 | round }}px;
      margin-bottom: 15px;
    }
  }
  
  .beautiful-newsletter-popup__description {
    font-size: {{ description_size }}px;
    color: #ffffff;
    margin-bottom: 30px;
    max-width: 100%;
    width: 100%;
    line-height: 1.6;
  }
  
  @media (max-width: 749px) {
    .beautiful-newsletter-popup__description {
      font-size: {{ description_size | times: 0.95 | round }}px;
      margin-bottom: 20px;
    }
  }
  
  .beautiful-newsletter-popup__form {
    width: 100%;
    max-width: 100%;
  }
  
  .beautiful-newsletter-popup__email-label {
    display: block;
    font-size: {{ email_label_size }}px;
    font-weight: 600;
    color: #ffffff;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 10px;
    text-align: left;
  }
  
  @media (max-width: 749px) {
    .beautiful-newsletter-popup__email-label {
      font-size: {{ email_label_size | times: 0.95 | round }}px;
      margin-bottom: 8px;
    }
  }
  
  .beautiful-newsletter-popup__email-input {
    width: 100%;
    padding: {{ email_input_padding }}px {{ email_input_padding | times: 1.2 | round }}px;
    background: #ffffff;
    border: 2px solid #000000;
    color: #000000;
    font-size: {{ email_input_size }}px;
    margin-bottom: 15px;
    box-sizing: border-box;
    border-radius: 0;
  }
  
  @media (max-width: 749px) {
    .beautiful-newsletter-popup__email-input {
      padding: {{ email_input_padding | times: 0.9 | round }}px {{ email_input_padding }}px;
      font-size: {{ email_input_size | times: 0.95 | round }}px;
      margin-bottom: 12px;
    }
  }
  
  .beautiful-newsletter-popup__email-input::placeholder {
    color: #999999;
  }
  
  .beautiful-newsletter-popup__email-input:focus {
    outline: none;
    border-color: #ff0000;
  }
  
  .beautiful-newsletter-popup__button {
    width: 100%;
    padding: {{ button_padding }}px {{ button_padding | times: 1.5 | round }}px;
    background: #ff0000;
    color: #ffffff;
    border: none;
    font-size: {{ button_font_size }}px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 2px;
    cursor: pointer;
    transition: background 0.3s, transform 0.2s;
    border-radius: 0;
  }
  
  @media (max-width: 749px) {
    .beautiful-newsletter-popup__button {
      padding: {{ button_padding | times: 0.9 | round }}px {{ button_padding | times: 1.2 | round }}px;
      font-size: {{ button_font_size | times: 0.95 | round }}px;
    }
  }
  
  .beautiful-newsletter-popup__button:hover {
    background: #cc0000;
    transform: translateY(-2px);
  }
  
  .beautiful-newsletter-popup__right {
    background: #ffffff;
    position: relative;
    overflow: hidden;
    flex: 1;
    min-height: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  @media (max-width: 749px) {
    .beautiful-newsletter-popup__right {
      display: none !important;
    }
  }
  
  .beautiful-newsletter-popup__image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    position: absolute;
    top: 0;
    left: 0;
  }
  
  .beautiful-newsletter-popup__error,
  .beautiful-newsletter-popup__success {
    margin-top: 12px;
    padding: 10px 12px;
    border-radius: 4px;
    font-size: 13px;
    text-align: left;
  }
  
  @media (max-width: 749px) {
    .beautiful-newsletter-popup__error,
    .beautiful-newsletter-popup__success {
      font-size: 12px;
      padding: 8px 10px;
    }
  }
  
  .beautiful-newsletter-popup__error {
    background: rgba(255, 0, 0, 0.1);
    color: #ff0000;
    border: 1px solid #ff0000;
  }
  
  .beautiful-newsletter-popup__success {
    background: rgba(0, 255, 0, 0.1);
    color: #00ff00;
    border: 1px solid #00ff00;
  }
</style>

<div class="beautiful-newsletter-popup h-100 d-flex fd-column">
  <button class="beautiful-newsletter-popup__close js-popup-close-btn" type="button" data-dismiss="modal" aria-label="{{ 'accessibility.close_popup' | t }}">
    Ã—
  </button>
  
  <div class="beautiful-newsletter-popup__container">
    <!-- Left Column: Content -->
    <div class="beautiful-newsletter-popup__left">
      <div class="beautiful-newsletter-popup__logo">
        {% if logo_image %}
          {%- liquid
            assign logo_alt = logo_image.alt | default: shop.name
            assign logo_url = logo_image | image_url: width: 300
          -%}
          <img src="{{ logo_url }}" alt="{{ logo_alt }}" loading="eager">
        {% else %}
          {{ logo_text | replace: 'Q', '<span class="logo-accent">Q</span>' }}
        {% endif %}
      </div>
      
      <h2 class="beautiful-newsletter-popup__headline-main">
        {{ headline_main }}
      </h2>
      
      {% if headline_sub != blank %}
        <p class="beautiful-newsletter-popup__headline-sub">
          {{ headline_sub }}
        </p>
      {% endif %}
      
      <p class="beautiful-newsletter-popup__description">
        {{ description_text }}
      </p>
      
      <div class="beautiful-newsletter-popup__form">
        {%- form 'customer', id: form_id -%}
          <input type="hidden" name="contact[tags]" value="newsletter">
          
          <label for="email-{{ form_id }}" class="beautiful-newsletter-popup__email-label">
            {{ email_label }}
          </label>
          
          <input 
            id="email-{{ form_id }}"
            type="email" 
            name="contact[email]" 
            class="beautiful-newsletter-popup__email-input"
            value="{{ form.email }}" 
            placeholder="Email"
            aria-required="true"
            autocorrect="off"
            autocapitalize="off"
            autocomplete="email"
            {% if form.errors %} 
              autofocus 
              aria-invalid="true" 
              aria-describedby="{{ form_id }}-error" 
            {% elsif form.posted_successfully? %} 
              aria-describedby="{{ form_id }}-success"
            {% endif %}
            required
          >
          
          <button type="submit" class="beautiful-newsletter-popup__button">
            {{ button_text }}
          </button>
          
          {%- if form.errors -%}
            <div id="{{ form_id }}-error" class="beautiful-newsletter-popup__error" role="alert">
              {{ form.errors.translated_fields['email'] | capitalize }} {{ form.errors.messages['email'] }}
            </div>
          {%- endif -%}
          
          {%- if form.posted_successfully? -%}
            <div id="{{ form_id }}-success" class="beautiful-newsletter-popup__success" role="alert">
              {{ 'general.newsletter.success' | t }}
            </div>
          {%- endif -%}
        {%- endform -%}
      </div>
    </div>
    
    <!-- Right Column: Image -->
    <div class="beautiful-newsletter-popup__right">
      {% if section.settings.right_image %}
        {%- liquid
          assign image_alt = section.settings.right_image.alt | default: 'Newsletter'
          assign image_url = section.settings.right_image | image_url: width: 800
        -%}
        <img 
          src="{{ image_url }}" 
          alt="{{ image_alt }}"
          class="beautiful-newsletter-popup__image"
          loading="eager"
        >
      {% else %}
        <div style="width: 100%; height: 100%; background: #f5f5f5; display: flex; align-items: center; justify-content: center; color: #999; font-size: 18px;">
          Image Placeholder
        </div>
      {% endif %}
      
    </div>
  </div>
</div>
