{%- liquid
  assign loading = "lazy"
  assign decoding ="async"
  assign fetchpriority = "auto"
  assign current_item = ''
  assign loaded_item = 'loaded="true"'
  if forloop.first
    assign current_item = ' js-slideshow-image--current'
    if section.index == 1
      assign loading = "eager"
      assign fetchpriority = "high"
    endif
  endif

  # Build picture element with responsive sources
  # Desktop image for screens >= 769px, mobile image for smaller screens

  assign overlay = block.settings.image_overlay_opacity
  assign overlay_color = ''
  unless block.settings.slide_mask_overlay_color.alpha == 0.0 or block.settings.slide_mask_overlay_color == blank
    assign overlay_color =  '--color-page-bg-rgb:' | append: block.settings.slide_mask_overlay_color.red | append: ',' | append: block.settings.slide_mask_overlay_color.green | append: ',' | append: block.settings.slide_mask_overlay_color.blue
  endunless
  unless block.settings.slide_content_overlay_color.alpha == 0.0 or block.settings.slide_content_overlay_color == blank
    assign content_color =  'color:' | append: block.settings.slide_content_overlay_color
  endunless

  assign min_height_mobile = section.settings.height_mobile
  assign min_height_desktop = section.settings.height_desktop
  if min_height_desktop == "adapt_img"
    assign min_height_desktop = ""
    if block.settings.desktop_image == blank
      assign min_height_desktop = "400px"
    endif
    assign min_height_desktop = 100 | divided_by : block.settings.desktop_image.aspect_ratio | append: 'vw'
  endif
  if min_height_mobile == "adapt_img"
    assign min_height_mobile = ""
    assign min_height_mobile = 100 | divided_by : block.settings.mobile_image.aspect_ratio | append: 'vw'
    if block.settings.mobile_image == blank
      assign min_height_mobile = 100 | divided_by : block.settings.desktop_image.aspect_ratio | append: 'vw'
    endif
    if block.settings.mobile_image == blank and block.settings.desktop_image == blank
      assign min_height_mobile = "400px"
    endif
  endif

-%}

<div role="group" aria-roledescription="Slide" aria-label="{{ 'accessibility.slide' | t }} {{ forloop.index }} {{ 'accessibility.of' | t }} {{ forloop.length }}" class="{{ fullwidth_banner_class }} slider-slide slider-slide-{{ forloop.index }} js-slideshow-item scrollable-aln-start miw d-grid p-relative" style="--miw:100%; --mh-xs: {{- min_height_mobile -}};--mh-sm: {{- min_height_desktop -}};" aria-hidden="true" {{ block.shopify_attributes }}>
  <div class="w-100 h-100 p-relative">
    {%- if block.settings.slide_link != blank -%}
      {%- liquid
        assign banner_link = 'd-block'
        if block.settings.primary_button_label != blank and block.settings.primary_button_link != blank
          assign banner_link = 'd-none-important'
        endif
        if block.settings.secondary_button_label != blank and block.settings.secondary_button_link != blank
          assign banner_link = 'd-none-important'
        endif

        if block.settings.desktop_image != blank or block.settings.mobile_image != blank
          assign image_loader = 'image-loader'
        endif
      -%}
        <a href="{{- block.settings.slide_link -}}" class="{{ banner_link }} js-slideshow-link p-absolute top-0 right-0 bottom-0 left-0 zi-3" target="_blank" aria-label="{{- block.settings.heading |  escape -}}"></a>
    {%- endif -%}
    <sht-image-atf class="js-slideshow-image o-hidden {{ image_loader }} {{ fullwidth_banner_class }} h-100 p-absolute center-middle sht-mask zi-1 {{ current_item }}" data-slideshow-index="{{ forloop.index }}" style="--overlay: {{ overlay }}; {{ overlay_color }};">
      <sht-slideshow-load-img data-section-id="{{ section.id }}" class="js-wrap-image-lazy d-block w-100 h-100 no-animation" {{- loaded_item -}}>
        <div class="d-block w-100 h-100 no-animation">
          {%- liquid
            assign slide_desktop_image_alt = block.settings.desktop_image.alt | default: block.settings.desktop_image | split: '/' | last
            assign slide_mobile_image_alt = block.settings.mobile_image.alt | default: block.settings.mobile_image | split: '/' | last
          -%}

          <picture class="js-slideshow-picture d-block w-100 h-100 no-animation">
            {%- if block.settings.mobile_image != blank -%}
              <source
                srcset="
                  {{ block.settings.mobile_image | image_url: width: 240 }} 240w,
                  {{ block.settings.mobile_image | image_url: width: 352 }} 352w,
                  {{ block.settings.mobile_image | image_url: width: 832 }} 832w
                "
                sizes="100vw"
                media="(max-width: 768px)"
              >
            {%- endif -%}

            {%- if block.settings.desktop_image != blank -%}
              <source
                srcset="
                  {{ block.settings.desktop_image | image_url: width: 240 }} 240w,
                  {{ block.settings.desktop_image | image_url: width: 352 }} 352w,
                  {{ block.settings.desktop_image | image_url: width: 832 }} 832w,
                  {{ block.settings.desktop_image | image_url: width: 1200 }} 1200w,
                  {{ block.settings.desktop_image | image_url: width: 1600 }} 1600w,
                  {{ block.settings.desktop_image | image_url: width: 1920 }} 1920w,
                  {{ block.settings.desktop_image | image_url: width: 2560 }} 2560w,
                  {{ block.settings.desktop_image | image_url: width: 3840 }} 3840w
                "
                sizes="100vw"
                media="(min-width: 769px)"
              >
            {%- endif -%}

            {%- if block.settings.desktop_image != blank or block.settings.mobile_image != blank -%}
              {%- liquid
                assign fallback_image = block.settings.desktop_image | default: block.settings.mobile_image
                assign fallback_alt = slide_desktop_image_alt | default: slide_mobile_image_alt
                echo fallback_image | image_url: width: fallback_image.width | image_tag: alt: fallback_alt, class: 'd-block w-100 h-100 of-cover p-absolute center-middle', loading: loading, fetchpriority: fetchpriority, decoding: decoding
              -%}
            {%- else -%}
              {{ 'hero-apparel-1' | placeholder_svg_tag: 'd-block w-100 h-100 bg-light' }}
            {%- endif -%}
          </picture>
        </div>
      </sht-slideshow-load-img>
    </sht-image-atf>
    <div class="slider__content o-hidden h-100 ctnr d-flex p-relative zi-2 content--special {{ content_classes }} {% if content_position == 'left-bottom' %}content_position{% endif %}" style="{{- content_color -}};">
      <div class="s-header pb-0" style="--w-xs:12;--w-md:8;">
        <div class="slider__content-item s-header__sub hide-empty d-inline-block fw-700 tt-up {{ subheading_style }}" style="--delay: .3s">{{- block.settings.sub_heading | escape -}}</div>
        <h2 class="slider__content-item s-header__title {{ margin_auto }} mb-0 hide-empty {{ heading_style }}" style="--delay: .35s">{{- block.settings.heading | escape -}}</h2>
        <div class="slider__content-item s-header__desc text-block hide-empty{% if content_position == 'center' %} m-sides{% endif %}" style="--delay: .4s">{{- block.settings.description -}}</div>
        <sht-slideshow-cta class="slider__content-item s-header__buttons slideshow__buttons d-inline-flex fw-wrap gap-12 gap-md-16{% if content_position == 'center' %} center-xs{% endif %}" style="--delay: .45s">
          {%- if block.settings.primary_button_label != blank -%}
          <a href="{{ block.settings.primary_button_link | default: '#' }}" role="link" class="btn btn-primary--animate btn-large js-slideshow-cta hide-empty" tabindex="-1" aria-hidden="true">
            <span class="d-block o-hidden p-relative">
              <span class="btn-primary__content">
                {{- block.settings.primary_button_label | escape -}}
              </span>
            </span>
          </a>
          {%- endif -%}
          {%- if block.settings.secondary_button_label != blank -%}
          <a href="{{ block.settings.secondary_button_link | default: '#' }}" role="link" class="btn btn-secondary--animate btn-large js-slideshow-cta hide-empty" tabindex="-1" aria-hidden="true">
            <span class="d-block o-hidden p-relative">
              <span class="btn-secondary__content">
                {{- block.settings.secondary_button_label | escape -}}
              </span>
            </span>
          </a>
          {%- endif -%}
        </sht-slideshow-cta>
      </div>
    </div>
  </div>
</div>