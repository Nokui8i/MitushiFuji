!function(){"use strict";let o={API_BASE:"https://ac.sht.cx/api/tracking",SCRIPT_VERSION:"1.0.0",CACHE_DURATION:36e5,DEBUG:!1},i="sht_script_cache",r="sht_last_update";function s(e){o.DEBUG&&console.log("[SHT]",e)}function t(e){try{var t=document.createElement("script");t.textContent=e,t.setAttribute("data-sht-loaded","true"),document.head.appendChild(t),s("Script executed successfully")}catch(e){s("Script execution failed: "+e.message)}}function a(){var e=function(){try{var e=localStorage.getItem(i),t=localStorage.getItem(r);if(e&&t)if(Date.now()-parseInt(t)<o.CACHE_DURATION)return s("Using cached script"),e}catch(e){s("Cache read failed: "+e.message)}return null}();e?t(e):(s("Loading script from API"),new Promise((a,n)=>{let c=new XMLHttpRequest,e=`${o.API_BASE}/events?v=${o.SCRIPT_VERSION}&t=`+Date.now();c.open("GET",e,!0),c.setRequestHeader("Accept","application/javascript"),c.onload=function(){if(200===c.status){var e=c.responseText,t=e;try{localStorage.setItem(i,t),localStorage.setItem(r,Date.now().toString()),s("Script cached")}catch(e){s("Cache write failed: "+e.message)}a(e)}else n(Error(`HTTP ${c.status}: `+c.statusText))},c.onerror=function(){n(Error("Network error"))},c.send()}).then(e=>{t(e)}).catch(e=>{s("Failed to load script: "+e.message),window.SHT_FALLBACK_SCRIPT&&(s("Using fallback script"),t(window.SHT_FALLBACK_SCRIPT))}))}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",a):a(),document.addEventListener("shopify:section:load",function(e){s("Section reloaded, reinitializing"),setTimeout(a,100)}),document.addEventListener("shopify:block:select",function(e){s("Block selected, reinitializing"),setTimeout(a,100)})}();